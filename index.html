<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Avatar Iframe CloneByMe</title>
  <style>
    /* Container with two panels */
    .container {
      display: flex;
      height: 98vh;
    }
    /* Left panel: iframe */
    .left-panel {
      flex: 1;
    }
    /* Right panel: messages and input */
    .right-panel {
      width: 60%;
      padding: 10px;
      display: flex;
      flex-direction: column;
    }
    /* Info text above the message display */
    .display-info {
      text-align: center;
      color: #888;
      margin-bottom: 10px;
    }
    /* Area to display messages */
    .message-display {
      flex: 1;
      border: 1px solid #ccc;
      padding: 10px;
      overflow-y: auto;
      margin-bottom: 10px;
    }
    /* Input area */
    .message-input {
      display: flex;
    }
    .message-input input {
      flex: 1;
      padding: 5px;
      font-size: 16px;
    }
    .message-input button {
      padding: 5px 10px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Left panel: Chat Iframe -->
    <div class="left-panel">
        <iframe id="chat-iframe" 
            src="https://app.clonebyme.com/chat-widget?avatar=[YOUR_AVATAR_TOKEN]" 
            style="width: 100%; height: 100%; border: none;" 
            allow="camera; microphone">
        </iframe>
    </div>

    <!-- Right panel: Display info, Message Display and Input -->
    <div class="right-panel">
      <!-- Info text -->
      <div class="display-info">
        This area receives messages from the iframe
      </div>
      <!-- Message Display Area -->
      <div class="message-display" id="message-display">
        <!-- Received messages and images will appear here -->
      </div>
      <div class="display-info">
        This area send messages to the iframe
      </div>
      <!-- Input Area to Send Message -->
      <div class="message-input">
        <input type="text" id="message-input" placeholder="Send text to iframe" />
        <button id="send-button">Send</button>
      </div>
    </div>
  </div>

  <script>
    // Listen for messages from the iframe
    window.addEventListener("message", (event) => {
      if (event.data.type === "NEW_QUESTION") {
        addMessage("Question: " + event.data.message);
      }
      if (event.data.type === "NEW_IMAGE") {
        addImage(event.data.imageBase64);
      }
    });

    // Add a text message to the display area
    function addMessage(text) {
      const display = document.getElementById("message-display");
      const msgDiv = document.createElement("div");
      msgDiv.textContent = text;
      display.appendChild(msgDiv);
    }

    // Add an image to the display area
    function addImage(src) {
      const display = document.getElementById("message-display");
      const img = document.createElement("img");
      img.src = src;
      img.style.maxWidth = "100%";
      display.appendChild(img);
    }

    // Send message to the iframe
    function sendMessage(message) {
      const iframe = document.getElementById("chat-iframe");
      if (iframe && iframe.contentWindow) {
        iframe.contentWindow.postMessage({ type: "TALK", message: message }, "*");
      }
    }

    // Send message when button is clicked
    document.getElementById("send-button").addEventListener("click", () => {
      const input = document.getElementById("message-input");
      const message = input.value.trim();
      if (message) {
        sendMessage(message);
        input.value = ""; // Clear input
      }
    });

    // Send message when Enter key is pressed
    document.getElementById("message-input").addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        document.getElementById("send-button").click();
      }
    });
  </script>
</body>
</html>
